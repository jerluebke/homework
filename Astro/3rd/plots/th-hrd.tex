\tikzexternalenable
\tikzsetnextfilename{exthhrd}

\begin{tikzpicture}

\begin{axis}[%
    set layers,
    width=17cm,
    height=22cm,
    title=Theoretical HR Diagram: V/19,
    title style={font=\large},
    xlabel=$T/\si{\kelvin}$,
    ylabel=$L/\si{\solarlum}$,
    label style={font=\small},
    x label style={yshift=.2em},
    y label style={yshift=-.8em},
    ticklabel style={font=\small},
    x dir=reverse,
    xmode=log,
    ymode=log,
    xmax=10e5,
    xmin=10e1,
    ymax=10e8,
    ymin=10e-5,
    grid=major,
    view={0}{90},
    colormap={mycm}{color=(gray),color=(gray)},
    legend entries={V/19, V/19/Hyades, Aldebaran},
    legend cell align=left,
    legend pos=south west,
    legend style={rounded corners,mark size=3pt}
]
    \addplot+ [%
        blue!80!black,
        only marks,
        mark options={fill=blue!60!white,}
    ] table [%
        x=T,
        y=L,
        col sep=comma
    ] {asu-piskunov1980-nolog.csv};

    \addplot+ [%
        yellow!60!black,
        mark=*,
        only marks,
        mark options={thick,fill=yellow!80!white}
    ] table [%
        x=T,
        y=L,
        col sep=comma
    ] {asu-piskunov1980-hyades-nolog.csv};

    \addplot+ [%
        green!60!black,
        mark=*,
        only marks,
        mark size=3pt,
        mark options={thick,fill=green!80!white}
    ] coordinates {%
        (3910, 518)
    };

    \addplot [%
        contour prepared={labels=false},
        contour plot/.style={draw color=grey},
    ] table {%
        1e6     9e-4    1e-6
        5.772e5 1e-4    1e-6

        1e6     9       1e-4
        5.772e4 1e-4    1e-4

        1e6     9e4     1e-2
        5.772e3 1e-4    1e-2

        1e6     9e8     1
        5.772e2 1e-4    1

        1e6     9e12    1e2
        5.772e1 1e-4    1e2

        1e6     9e16    1e4
        5.772   1e-4    1e4

        1e6     9e20    1e6
        5.772e-1    1e-4    1e6
    };

    \pgfonlayer{axis foreground}
        \node [align=center,
            % draw,
            fill=white,
            inner sep=1pt,font=\scriptsize,rotate=-59]
            at (axis cs: 324583, 1e-1) {\SI{1e-4}{\solarradii}};
        \node [align=center, fill=white, inner sep=1pt,font=\scriptsize,rotate=-59]
            at (axis cs: 324583, 1e3) {\SI{1e-2}{\solarradii}};
        \node [align=center, fill=white, inner sep=1pt,font=\scriptsize,rotate=-59]
            at (axis cs: 324583, 1e7) {\SI{1}{\solarradii}};
        \node [align=center, fill=white, inner sep=1pt,font=\scriptsize,rotate=-59]
            at (axis cs: 57720, 1e8) {\SI{1e2}{\solarradii}};
        \node [align=center, fill=white, inner sep=1pt,font=\scriptsize,rotate=-59]
            at (axis cs: 5772, 1e8) {\SI{1e4}{\solarradii}};
        \node [align=center, fill=white, inner sep=1pt,font=\scriptsize,rotate=-59]
            at (axis cs: 577, 1e8) {\SI{1e6}{\solarradii}};
    \endpgfonlayer

\end{axis}

\end{tikzpicture}

\tikzexternaldisable
